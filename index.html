<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>USAF PT Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body {font-family:Arial,Helvetica,sans-serif;margin:0;padding:0 1rem;background:#f2f2f2;}
  .wrapper {max-width:800px;margin:2rem auto;background:#fff;padding:1.5rem;
           border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.15);}
  h1 {text-align:center;margin-bottom:1.5rem;}
  form {display:flex;flex-direction:column;gap:1rem;}
  fieldset {border:1px solid #999;padding:1rem;border-radius:5px;}
  legend {font-weight:bold;padding:0 .5rem;}
  label {display:flex;flex-direction:column;font-weight:600;margin-top:.5rem;}
  .test-select {margin-top:.5rem;}
  select, button {width:100%;padding:.6rem;font-size:1rem;
                 border:1px solid #999;border-radius:4px;box-sizing:border-box;}
  button {background:#0066cc;color:#fff;cursor:pointer;font-weight:600;}
  button:hover {background:#0055aa;}
  .result {margin-top:2rem;padding:1rem;border:2px solid #444;background:#fafafa;}
  .pass {color:#0a0;font-weight:bold;}
  .fail {color:#c00;font-weight:bold;}
  @media (max-width:380px){
    h1{font-size:1.5rem}
    select, button{font-size:.95rem}
  }
</style>
</head>
<body>
<div class="wrapper">
  <h1>USAF PT Calculator</h1>

  <form id="ptForm">

    <!-- ====================== GENDER & AGE ====================== -->
    <fieldset>
      <legend>Demographics</legend>
      <label>Gender
        <select id="gender" required>
          <option value="male">Male</option>
          <option value="female">Female</option>
        </select>
      </label>

      <label>Age (years)
        <input type="number" id="age" min="17" max="80" required placeholder="e.g. 27">
      </label>
    </fieldset>

    <!-- ====================== CARDIO SECTION ====================== -->
    <fieldset>
      <legend>Cardio – Choose ONE</legend>

      <label><input type="radio" name="cardio" value="run" checked> 2‑Mile Run</label>
      <label><input type="radio" name="cardio" value="hamr"> HAMR (20‑m Shuttle)</label>

      <!-- Run dropdown (visible when “run” radio is selected) -->
      <select id="runSelect" class="test-select"></select>

      <!-- HAMR dropdown (visible when “hamr” radio is selected) -->
      <select id="hamrSelect" class="test-select" style="display:none;"></select>
    </fieldset>

    <!-- ====================== PUSH‑UPS SECTION ====================== -->
    <fieldset>
      <legend>Upper‑Body – Choose ONE</legend>

      <label><input type="radio" name="push" value="pushups" checked> Push‑ups (1 min)</label>
      <label><input type="radio" name="push" value="handRelease"> Hand‑Release Push‑ups (2 min)</label>

      <select id="pushSelect" class="test-select"></select>
      <select id="handSelect" class="test-select" style="display:none;"></select>
    </fieldset>

    <!-- ====================== CORE SECTION ====================== -->
    <fieldset>
      <legend>Core – Choose ONE</legend>

      <label><input type="radio" name="core" value="situps" checked> Sit‑ups (1 min)</label>
      <label><input type="radio" name="core" value="crunch"> Reverse Crunch (2 min)</label>
      <label><input type="radio" name="core" value="plank"> Forearm Plank (seconds)</label>

      <select id="sitSelect" class="test-select"></select>
      <select id="crunchSelect" class="test-select" style="display:none;"></select>
      <select id="plankSelect" class="test-select" style="display:none;"></select>
    </fieldset>

    <!-- ====================== WHtR ====================== -->
    <h3>Waist‑to‑Height Ratio (WHtR)</h3>
    <label>Waist (inches)
      <input type="number" id="waist" min="10" max="80" required placeholder="e.g. 34">
    </label>

    <label>Height (inches)
      <input type="number" id="height" min="48" max="84" required placeholder="e.g. 70">
    </label>

    <button type="submit">Calculate Score</button>
  </form>

  <div id="output" class="result" style="display:none;"></div>
</div>

<script>
/* --------------------------------------------------------------
   Helper functions
   -------------------------------------------------------------- */
function mmssToSec(str){ const [m,s] = str.split(':').map(Number); return m*60+s; }

function getAgeBucket(age){
  if (age < 25) return "<25";
  if (age <= 29) return "25-29";
  if (age <= 34) return "30-34";
  if (age <= 39) return "35-39";
  if (age <= 44) return "40-44";
  if (age <= 49) return "45-49";
  if (age <= 54) return "50-54";
  if (age <= 59) return "55-59";
  return "60+";
}

/* Numeric lookup – greatest key ≤ value */
function lookupNumeric(table, val){
  const keys = Object.keys(table).map(Number).sort((a,b)=>a-b);
  let pts = 0;
  for (let i = keys.length-1; i >= 0; i--) {
    if (val >= keys[i]) { pts = table[keys[i]]; break; }
  }
  return pts;
}

/* Run‑time lookup – smallest time ≥ value */
function lookupRun(table, secs){
  const rows = Object.entries(table)
    .map(([k,v])=>[mmssToSec(k),v])
    .sort((a,b)=>a[0]-b[0]);
  let pts = 0;
  for (let i = rows.length-1; i >= 0; i--) {
    if (secs <= rows[i][0]) { pts = rows[i][1]; break; }
  }
  return pts;
}

/* WHtR ladder – same for every bucket */
const WHTR_TABLE = {
  "0.49":20,"0.50":19,"0.51":18,"0.52":17,"0.53":16,"0.54":15,
  "0.55":12.5,"0.56":10,"0.57":7.5,"0.58":5,"0.59":2.5,"0.60":0
};
function lookupWhtr(waist, height){
  const ratio = (waist/height).toFixed(2);
  const keys = Object.keys(WHTR_TABLE).map(Number).sort((a,b)=>a-b);
  let pts = 0, category = "High Risk";
  for (let i = keys.length-1; i >= 0; i--) {
    if (ratio <= keys[i]) {
      pts = WHTR_TABLE[keys[i].toFixed(2)];
      category = (keys[i] <= 0.49) ? "Low Risk"
                : (keys[i] < 0.60) ? "Moderate Risk"
                : "High Risk";
      break;
    }
  }
  return {pts,
